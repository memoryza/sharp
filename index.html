<!DOCTYPE html>
    <head>
  	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <title>sharp</title>

        <style type="text/css">
            input{
                width: 500px;
            }

        </style>
    </head>
    <body>
        <input type="text" id="input" placeholder = '打开控制台 并在文本框内输入 ： 00、01、02、10、11、12...'>

        <script type="text/javascript">
            var doc = document; 

            var array,step,turn;
            function init(){
                array = [[null,null,null],[null,null,null],[null,null,null]];
                step = 0;
                turn = 'human';
            }

            init();

            var _input = doc.querySelector('input');

            _input.addEventListener('change',function(){
                var _v1 = ~~this.value.slice(0,1);
                var _v2 = ~~this.value.slice(1,2);
                if(!array[_v1]){return false;}
                if(array[_v1][_v2] !== null){return false;}
                array[_v1][_v2] = 'you';
                render();
                judgeWin();
                comTurn();
                step++;
            });

            function comTurn(){
                var putsArray = findPuts();
                step++;
            }



            //每个格都有权重分配
            //查找自己能够获胜的点 权重分配为 ＋40
            //查找对方能够获胜的点 权重分配为 ＋18
            //能为自己连成2个点并且可以获胜 权重 ＋3
            //有获胜希望的 权重 ＋1
            //能够阻止对方连成2个点 并有获胜希望的 权重 ＋2
            function findPuts(){
                var wight_array = [[0,0,0],[0,0,0],[0,0,0]];
                for(var i=0;i<array.length;i++){
                    for(var j=0;j<array.length;j++){
                        if(array[i][j] !== null ){continue;}
                        // var _w = wight_array[i][j];

                        var x1 = array[i][(j+1)%3],x2 = array[i][(j+2)%3],
                        y1 = array[(i+1)%3][j],y2 = array[(i+2)%3][j],
                        o1,o2,o3,o4;

                        if(i == 0 && j == 0){
                            o1 = array[1][1];
                            o2 = array[2][2];
                        }

                        if(i == 1 && j == 1){
                            o1 = array[0][0];
                            o2 = array[2][2];
                            o3 = array[0][2];
                            o4 = array[2][0];
                        }

                        if(i == 2 && j == 2){
                            o1 = array[0][0];
                            o2 = array[1][1];
                        }

                        if(i == 0 && j == 2){
                            o1 = array[2][0];
                            o2 = array[1][1];
                        }

                        if(i == 2 && j == 0){
                            o1 = array[0][2];
                            o2 = array[1][1];
                        }

                        if(x1==x2 && x1 !== null){
                            if(x1=='com'){
                                wight_array[i][j] += 40;
                            }else{
                                wight_array[i][j] += 18;
                            }
                        }

                        if(y1 == y2 && y1 !== null){
                            if(y1 == 'com'){
                                wight_array[i][j] += 40;
                            }else{
                                wight_array[i][j] += 18;
                            }
                        }

                        if( (x1 !== null && x2 == null) || (x1 == null && x2 !== null) ){
                            if(x1 == 'com' || x2 == 'com'){
                                wight_array[i][j] += 3;
                            }else{
                                wight_array[i][j] += 2;
                            }
                        }

                        if( (y1 !== null && y2 == null) || (y1 == null && y2 !== null) ){
                            if(x1 == 'com' || x2 == 'com'){
                                wight_array[i][j] += 3;
                            }else{
                                wight_array[i][j] += 2;
                            }
                        }

                        if( x1 == null && x2 == null ){
                            wight_array[i][j] += 1;
                        }

                        if( y1 == null && y2 == null ){
                            wight_array[i][j] += 1;
                        }



                        if(o1 !== undefined){
                            if(o1 == o2 && o1 !== null){
                                if(o1=='com'){
                                    wight_array[i][j] += 40;
                                }else{
                                    wight_array[i][j] += 18;
                                }
                            }
                            if( (o1 !== null && o2 == null) || (o1 == null && o2 !== null) ){
                                if(o1 == 'com' || o2 == 'com'){
                                    wight_array[i][j] += 3;
                                }else{
                                    wight_array[i][j] += 2;
                                }
                            }
                            if( o1 == null && o2 == null ){
                                wight_array[i][j] += 1;
                            }
                        }

                        if(o3 !== undefined){
                            if(o3 == o4 && o3 !== null){
                                if(o3=='com'){
                                    wight_array[i][j] += 40;
                                }else{
                                    wight_array[i][j] += 18;
                                }
                            }
                            if( (o3 !== null && o4 == null) || (o3 == null && o4 !== null) ){
                                if(o3 == 'com' || o4 == 'com'){
                                    wight_array[i][j] += 3;
                                }else{
                                    wight_array[i][j] += 2;
                                }
                            }
                            if( o3 == null && o4 == null ){
                                wight_array[i][j] += 1;
                            }
                        }

                    }
                }

                console.log('=============');
                console.log(wight_array[0]);
                console.log(wight_array[1]);
                console.log(wight_array[2]);

            }

            function render(){
                console.clear();
                console.log(array[0]);
                console.log(array[1]);
                console.log(array[2]);
            }

            function next(){
                if(turn == 'human'){
                    turn = 'computer';
                }else{
                    turn = 'human'
                }
            }

            function judgeWin(){
                for(var i=0;i<array.length;i++){
                    for(var j=0;j<array[i].length;j++){
                        if(array[i][j] == null){continue;}

                        if(array[i][j%3] == array[i][(j+1)%3] && array[i][(j+1)%3]  == array[i][(j+2)%3] ){
                            alert(array[i][j] + ' win!');
                            init();
                            break;
                        }

                        if(array[i%3][j] == array[(i+1)%3][j] &&  array[(i+1)%3][j]  ==  array[(i+2)%3][j] ){
                            alert(array[i][j]+ ' win!');
                            init();
                            break;
                        }
                    }

                    if(array[0][0] && array[0][0] == array[1][1] && array[1][1]  == array[2][2]){
                        alert(array[0][0]+ ' win!');
                        init();
                        return;
                    }

                    if(array[2][0] && array[2][0] == array[1][1] && array[1][1]  == array[0][2]){
                        alert(array[0][0]+ ' win!');
                        init();
                        return;
                    }

                }
            }


        </script>
    </body>
</html>